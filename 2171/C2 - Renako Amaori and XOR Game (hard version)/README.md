<h3><a href="https://codeforces.com/contest/2171/problem/C2" target="_blank" rel="noopener noreferrer">Renako Amaori and XOR Game (hard version)</a></h3>

<div class="header"><div class="title">C2. Renako Amaori and XOR Game (hard version)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><div class="epigraph"><div class="epigraph-text"><span class="tex-font-style-it">Yup. I couldn't do this any longer. No. Freaking. Way.</span></div><div class="epigraph-source">— Renako Amaori</div></div><p><span class="tex-font-style-bf">This is the hard version of the problem. The only difference between the easy and hard versions is that in the hard version, $$$a_i, b_i \leq 10^6$$$.</span></p><p><span class="tex-font-style-it">Renako is stuck between a rock and a hard place... and by that, of course, I mean Ajisai and Mai! Both of them want to hang out with her, and she just can't decide! So Ajisai and Mai have decided to play the XOR game.</span></p><p>Ajisai and Mai are given arrays $$$a$$$ and $$$b$$$ of length $$$n$$$ ($$$0\leq a_i, b_i\leq {\color{red}{10^6}}$$$). They will play a game that lasts for $$$n$$$ turns, where Ajisai moves on odd-numbered turns and Mai moves on even-numbered turns. On the $$$i$$$-th turn, the player to move may choose to swap $$$a_i$$$ and $$$b_i$$$, or pass.</p><p>Note that if a swap occurs, <span class="tex-font-style-bf">the index that is being swapped must match the turn number</span>. For example, on the first turn, Ajisai may choose to swap $$$a_1$$$ and $$$b_1$$$, or pass. On the second turn, Mai may choose to swap $$$a_2$$$ and $$$b_2$$$, or pass. This continues for $$$n$$$ turns. Thus, only Ajisai can swap odd indices, and only Mai can swap even indices.</p><p>At the end of the game, Ajisai achieves a score of $$$a_1 \oplus a_2 \oplus \dots \oplus a_n$$$, and Mai achieves a score of $$$b_1 \oplus b_2 \oplus \dots \oplus b_n$$$$$$^{\text{∗}}$$$. The player with the higher score wins. If the players have the same score, the game ends in a tie.</p><p>Determine the outcome of the game with optimal play. More formally, one player is considered to win with optimal play if there exists a strategy for them such that they always win, regardless of their opponent's choices. The game is considered a tie with optimal play if neither player has such a strategy.</p><div class="statement-footnote"><p>$$$^{\text{∗}}$$$$$$\oplus$$$ denotes the <a href="https://en.wikipedia.org/wiki/Bitwise_operation#XOR">bitwise XOR operation</a></p></div></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a single integer $$$t$$$ ($$$1\leq t\leq 10^4$$$)  — the number of test cases.</p><p>The first line of each test case contains a single integer $$$n$$$ ($$$1\leq n\leq 2\cdot 10^5$$$).</p><p>The second line of each test case contains $$$n$$$ integers, $$$a_1, a_2, \dots, a_n$$$ ($$$0\leq a_i\leq 10^6$$$).</p><p>The third line of each test case contains $$$n$$$ integers, $$$b_1, b_2, \dots, b_n$$$ ($$$0\leq b_i\leq 10^6$$$).</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2\cdot 10^5$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case, output on a single line "<span class="tex-font-style-tt">Ajisai</span>" if Ajisai wins with optimal play, "<span class="tex-font-style-tt">Mai</span>" if Mai wins with optimal play, or "<span class="tex-font-style-tt">Tie</span>" if the game ends in a tie with optimal play.</p><p>You may output the answer in any case (upper or lower). For example, the strings "<span class="tex-font-style-tt">mAi</span>", "<span class="tex-font-style-tt">mai</span>", "<span class="tex-font-style-tt">MAI</span>", and "<span class="tex-font-style-tt">maI</span>" will be recognized as "<span class="tex-font-style-tt">Mai</span>".</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id006159326097369807" id="id00652172298638355" class="input-output-copier">Copy</div></div><pre id="id006159326097369807"><div class="test-example-line test-example-line-even test-example-line-0">6</div><div class="test-example-line test-example-line-odd test-example-line-1">4</div><div class="test-example-line test-example-line-odd test-example-line-1">1 4 6 1</div><div class="test-example-line test-example-line-odd test-example-line-1">3 2 3 7</div><div class="test-example-line test-example-line-even test-example-line-2">6</div><div class="test-example-line test-example-line-even test-example-line-2">20 11 1 7 7 0</div><div class="test-example-line test-example-line-even test-example-line-2">14 8 3 6 17 6</div><div class="test-example-line test-example-line-odd test-example-line-3">4</div><div class="test-example-line test-example-line-odd test-example-line-3">2 6 3 6</div><div class="test-example-line test-example-line-odd test-example-line-3">3 4 7 1</div><div class="test-example-line test-example-line-even test-example-line-4">5</div><div class="test-example-line test-example-line-even test-example-line-4">1 4 5 5 3</div><div class="test-example-line test-example-line-even test-example-line-4">6 7 1 2 13</div><div class="test-example-line test-example-line-odd test-example-line-5">6</div><div class="test-example-line test-example-line-odd test-example-line-5">9 5 9 17 17 6</div><div class="test-example-line test-example-line-odd test-example-line-5">1 13 6 13 1 15</div><div class="test-example-line test-example-line-even test-example-line-6">5</div><div class="test-example-line test-example-line-even test-example-line-6">2 3 8 1 5</div><div class="test-example-line test-example-line-even test-example-line-6">3 1 6 14 7</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id002869816358120014" id="id006991512018585555" class="input-output-copier">Copy</div></div><pre id="id002869816358120014"><div class="test-example-line test-example-line-odd test-example-line-1">Mai</div><div class="test-example-line test-example-line-even test-example-line-2">Ajisai</div><div class="test-example-line test-example-line-odd test-example-line-3">Tie</div><div class="test-example-line test-example-line-even test-example-line-4">Ajisai</div><div class="test-example-line test-example-line-odd test-example-line-5">Mai</div><div class="test-example-line test-example-line-even test-example-line-6">Tie</div></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example, one way the game might play out is as follows:</p><p>On turn 1, Ajisai chooses to swap $$$a_1$$$ and $$$b_1$$$. Now the arrays are $$$a = [3, 4, 6, 1]$$$ and $$$b = [1, 2, 3, 7]$$$.</p><p>On turn 2, Mai chooses to swap $$$a_2$$$ and $$$b_2$$$. Now the arrays are $$$a = [3, 2, 6, 1]$$$ and $$$b = [1, 4, 3, 7]$$$.</p><p>On turn 3, Ajisai chooses to pass.</p><p>On turn 4, Mai chooses to swap $$$a_4$$$ and $$$b_4$$$. Now the arrays are $$$a = [3, 2, 6, 7]$$$ and $$$b = [1, 4, 3, 1]$$$.</p><p>Now, Ajisai's final score is $$$3\oplus 2\oplus 6\oplus 7 = 0$$$ and Mai's final score is $$$1\oplus 4\oplus 3\oplus 1 = 7$$$. Therefore, Mai wins the game.</p><p>It is not guaranteed that the above description is representative of optimal play.</p><p>For additional examples, see the examples of the easy version.</p></div>